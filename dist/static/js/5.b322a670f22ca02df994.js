webpackJsonp([5],{"+v6K":function(e,t){},"3omw":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("TVG1"),s={name:"createForm",components:{},props:{formItem:{type:Object,default:function(){return{}}}},data:function(){return{roles:[]}},watch:{},methods:{roleList:function(){var e=this;a.a.ajax.get("/roles").then(function(t){if(200==t.data.code){var r=t.data.data.list;for(var a in r)e.roles.push({value:r[a].serialNum,label:r[a].roleDesc})}else e.$Message.info("角色获取失败!")}).catch(function(e){console.log(e)})}},mounted:function(){this.roleList()},activated:function(){}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Form",{ref:"formItem",attrs:{model:e.formItem,"label-width":50}},[r("Row",[r("Col",{attrs:{span:"16"}},[r("FormItem",{attrs:{label:"用户名",prop:"userName"}},[r("Input",{model:{value:e.formItem.userName,callback:function(t){e.$set(e.formItem,"userName",t)},expression:"formItem.userName"}})],1)],1)],1),e._v(" "),r("Row",[r("Col",{attrs:{span:"16"}},[r("FormItem",{attrs:{label:"姓名",prop:"realName"}},[r("Input",{model:{value:e.formItem.realName,callback:function(t){e.$set(e.formItem,"realName",t)},expression:"formItem.realName"}})],1)],1)],1),e._v(" "),r("Row",[r("Col",{attrs:{span:"16"}},[r("FormItem",{attrs:{label:"密码",prop:"userPassword"}},[r("Input",{model:{value:e.formItem.userPassword,callback:function(t){e.$set(e.formItem,"userPassword",t)},expression:"formItem.userPassword"}})],1)],1)],1),e._v(" "),r("Row",[r("Col",{attrs:{span:"16"}},[r("FormItem",{attrs:{label:"角色",prop:"userRole"}},[r("Select",{attrs:{clearable:""},model:{value:e.formItem.roleSerialNum,callback:function(t){e.$set(e.formItem,"roleSerialNum",t)},expression:"formItem.roleSerialNum"}},e._l(e.roles,function(t){return r("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1),e._v(" "),r("Row",[r("Col",{attrs:{span:"16"}},[r("FormItem",{attrs:{label:"邮箱",prop:"mailAddr"}},[r("Input",{model:{value:e.formItem.mailAddr,callback:function(t){e.$set(e.formItem,"mailAddr",t)},expression:"formItem.mailAddr"}})],1)],1)],1),e._v(" "),r("Row",[r("Col",{attrs:{span:"16"}},[r("FormItem",{attrs:{label:"电话",prop:"phoneNum"}},[r("Input",{model:{value:e.formItem.phoneNum,callback:function(t){e.$set(e.formItem,"phoneNum",t)},expression:"formItem.phoneNum"}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var n={name:"user",components:{createForm:r("VU/8")(s,o,!1,function(e){r("+v6K")},null,null).exports},data:function(){var e=this;return{searchForm:{},userCol:[{type:"index",width:60,align:"center"},{title:"用户名",key:"userName"},{title:"角色",key:"roleDesc"},{title:"姓名",key:"realName"},{title:"用户编码",key:"uId"},{title:"创建时间",key:"created_date"},{title:"更新时间",key:"updated_date"},{title:"操作",key:"action",width:150,align:"center",render:function(t,r){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showUpdateFrom(r.row)}}},"编辑"),t("Poptip",{props:{confirm:!0,title:"您确定要删除这条数据吗?",transfer:!0},on:{"on-ok":function(){e.user_delete(r.row.uId)}}},[t("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"}},"删除")])])}}],userData:[],formItem:{realName:"",mailAddr:"",phoneNum:"",userName:"",roleSerialNum:"",userPassword:""},modalTitle:"",showCreateForm:!1,roles:[],currentPage:1,totalPage:1,pageSize:20}},methods:{lastPage:function(){this.currentPage>1?(this.currentPage--,this.user_list()):this.$Message.info("当前已经是第一页。")},nextPage:function(){this.currentPage<this.totalPage?(this.currentPage++,this.user_list()):this.$Message.info("没有更多的数据了。")},showCreateFrom:function(){this.modalTitle="添加账户",this.modalType="create",this.formItem={},this.showCreateForm=!0},showUpdateFrom:function(e){this.modalTitle="修改账户",this.modalType="update",this.formItem=e,this.showCreateForm=!0},rowClassName:function(e,t){return"table-info-pointer"},ok:function(){"create"==this.modalType?this.user_create(this.formItem):"update"==this.modalType&&this.user_update(this.formItem)},cancel:function(){this.showCreateForm=!1},user_list:function(){var e=this,t={};null!=this.searchForm.userName&&""!=this.searchForm.userName&&(t.userName=this.searchForm.userName),t.page_index=this.currentPage,t.pageSize=this.pageSize;var r="";for(var s in t)r+=s+"="+t[s]+"&";a.a.ajax.get("/users?"+r).then(function(t){if(200==t.data.code){var r=t.data.data.list;for(var s in e.totalPage=t.data.data.totalPage,r)r[s].userPassword="",r[s].created_date=a.a.formatDate(new Date(r[s].created_date),"yyyy-MM-dd hh:mm:ss"),r[s].updated_date=a.a.formatDate(new Date(r[s].updated_date),"yyyy-MM-dd hh:mm:ss"),null!==r[s].userRole&&(r[s].roleDesc=r[s].userRole.roleDesc);e.userData=r}else e.$Message.error("系统错误!")})},user_create:function(){var e=this;a.a.ajax.post("/users",this.formItem).then(function(t){200==t.data.code?(e.$Message.success("创建用户成功"),e.user_list()):e.$Message.error("系统错误!")})},user_update:function(e){var t=this;a.a.ajax.put("/users/"+e.uId,this.formItem).then(function(e){200==e.data.code?t.$Message.success("更新用户成功"):t.$Message.error("系统错误!")})},user_delete:function(e){var t=this;a.a.ajax.delete("/users/"+e).then(function(e){200==e.data.code?(t.$Message.success("删除用户成功"),t.user_list()):t.$Message.error("系统错误!")})},btnClick:function(){this.currentPage=1,this.user_list()}},mounted:function(){this.user_list()}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Row",[r("Card",[r("Row",{attrs:{gutter:24}},[r("Col",{attrs:{span:"6"}},[r("Input",{attrs:{placeholder:"用户名查询",size:"large"},model:{value:e.searchForm.userName,callback:function(t){e.$set(e.searchForm,"userName",t)},expression:"searchForm.userName"}},[r("Button",{attrs:{slot:"append",type:"primary",icon:"ios-search"},on:{click:e.btnClick},slot:"append"})],1)],1),e._v(" "),r("Col",{attrs:{span:"3",offset:"15"}},[r("Button",{attrs:{type:"info",long:"",icon:"plus-round",size:"large"},on:{click:e.showCreateFrom}},[e._v("添加用户")])],1)],1)],1)],1),e._v(" "),r("Row",{staticClass:"margin-top-10"},[r("Col",{attrs:{span:"24"}},[r("Table",{attrs:{"highlight-row":"",border:"",height:400,columns:e.userCol,data:e.userData}}),e._v(" "),r("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[r("Row",[r("Col",{attrs:{span:"6"}},[r("span",[e._v("当前第"+e._s(e.currentPage)+"页(总共"+e._s(e.totalPage)+"页)，每页显示20条记录")])]),e._v(" "),r("Col",{attrs:{span:"4",offset:"14"}},[r("ButtonGroup",{attrs:{shape:"circle"}},[r("Button",{attrs:{type:"ghost"},on:{click:e.lastPage}},[r("Icon",{attrs:{type:"chevron-left"}}),e._v("\n                            上一页\n                            ")],1),e._v(" "),r("Button",{attrs:{type:"ghost"},on:{click:e.nextPage}},[e._v("\n                            下一页\n                            "),r("Icon",{attrs:{type:"chevron-right"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("Modal",{attrs:{width:"400",styles:{top:"20px"}},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.showCreateForm,callback:function(t){e.showCreateForm=t},expression:"showCreateForm"}},[r("p",{staticStyle:{color:"#f60","text-align":"left"},attrs:{slot:"header"},slot:"header"},[r("Icon",{attrs:{type:"information-circled"}}),e._v(" "),r("span",[e._v(e._s(e.modalTitle))])],1),e._v(" "),r("create-form",{attrs:{formItem:e.formItem}})],1)],1)},staticRenderFns:[]};var i=r("VU/8")(n,l,!1,function(e){r("BhHr")},null,null);t.default=i.exports},BhHr:function(e,t){}});
//# sourceMappingURL=5.b322a670f22ca02df994.js.map